<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¡° í¸ì„± í”„ë¡œê·¸ë¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            overflow-x: hidden;
            zoom: 0.8;
        }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
        .main-layout {
            display: flex;
            gap: 20px;
            padding: 10px;
            height: calc(130vh - 120px);
        }

        /* ì™¼ìª½ 30% íŒ¨ë„ */
        .left-panel {
            width: 35%;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
        }

        .panel-section {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            padding: 15px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .section-header h3 {
            margin: 0;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }

        .controls-inline {
            display: flex;
            gap: 8px;
            align-items: center;
            font-size: 12px;
        }

        .count-input {
            padding: 6px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 12px;
            width: 50px;
        }

        .btn-sm {
            padding: 6px 10px;
            font-size: 11px;
        }

        .panel-section h3 {
            margin-bottom: 12px;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }

        .number-area {
            background-color: #f8fafc;
            border: 2px dashed #cbd5e0;
            border-radius: 6px;
            padding: 16px;
            min-height: 187px;
            transition: all 0.3s ease;
        }

        .number-area.drag-over {
            border-color: #3b82f6;
            background-color: #dbeafe;
        }

        .gender-split {
            display: flex;
            gap: 10px;
        }

        .gender-box {
            flex: 1;
            border: 2px dashed #cbd5e0;
            border-radius: 6px;
            padding: 26px;
            min-height: 260px;
            transition: all 0.3s ease;
        }

        .gender-box.male {
            background-color: #dbeafe;
            border-color: #3b82f6;
        }

        .gender-box.female {
            background-color: #fce7f3;
            border-color: #ec4899;
        }

        .gender-box.drag-over {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .gender-box h4 {
            margin-bottom: 21px;
            font-size: 31px;
            font-weight: 600;
            text-align: center;
        }

        .gender-box.male h4 {
            color: #1d4ed8;
        }

        .gender-box.female h4 {
            color: #be185d;
        }

        .numbers-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
        }

        /* ì˜¤ë¥¸ìª½ 70% íŒ¨ë„ */
        .right-panel {
            width: 65%;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 25px;
            overflow-y: auto;
        }

        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1f5f9;
        }

        .team-header h1 {
            color: #1e293b;
            font-size: 28px;
            font-weight: 700;
            margin: 0;
        }

        .team-controls {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        /* ì¡°ë³„ ì¹´ë“œ (ê°„ë‹¨í•œ ë””ìì¸) */
        .team {
            border: none;
            border-radius: 12px;
            padding: 20px;
            min-height: 600px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .team::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            border-radius: 12px 12px 0 0;
        }

        /* ì¡°ë³„ ìƒ‰ìƒ í…Œë§ˆ */
        .team:nth-child(1) { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); }
        .team:nth-child(1)::before { background: #3b82f6; }
        .team:nth-child(2) { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); }
        .team:nth-child(2)::before { background: #10b981; }
        .team:nth-child(3) { background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%); }
        .team:nth-child(3)::before { background: #f59e0b; }
        .team:nth-child(4) { background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); }
        .team:nth-child(4)::before { background: #ec4899; }
        .team:nth-child(5) { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%); }
        .team:nth-child(5)::before { background: #8b5cf6; }
        .team:nth-child(6) { background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); }
        .team:nth-child(6)::before { background: #06d6a0; }
        .team:nth-child(7) { background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%); }
        .team:nth-child(7)::before { background: #ef4444; }
        .team:nth-child(8) { background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); }
        .team:nth-child(8)::before { background: #0ea5e9; }
        .team:nth-child(9) { background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); }
        .team:nth-child(9)::before { background: #d97706; }
        .team:nth-child(10) { background: linear-gradient(135deg, #f7fee7 0%, #ecfccb 100%); }
        .team:nth-child(10)::before { background: #65a30d; }

        .team:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .team.drag-over {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 25px rgba(59, 130, 246, 0.3);
        }

        .team-title {
            text-align: center;
            margin-bottom: 15px;
        }

        .team-title h4 {
            margin: 0;
            color: #1e293b;
            font-size: 18px;
            font-weight: 700;
        }

        .team-members {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            min-height: 240px;
            align-items: flex-start;
            align-content: flex-start;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header {
            background-color: white;
            color: #333;
            padding: 10px 15px;
            border-radius: 6px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.1);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            margin: 0 0 4px 0;
            font-size: 20px;
            color: #333;
            display: flex;
            align-items: center;
        }

        .header h1::before {
            content: "ğŸ‘¥";
            margin-right: 10px;
            font-size: 24px;
        }

        .header-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        .btn {
            padding: 8px 14px;
            margin: 3px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }



        .student-number {
            background-color: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            padding: 7px 13px;
            text-align: center;
            cursor: grab;
            transition: all 0.3s ease;
            font-weight: 600;
            user-select: none;
            min-width: 44px;
            font-size: 18px;
        }

        .student-number:hover {
            background-color: #e2e8f0;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .student-number.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        /* ì¡°ë³„ í¸ì„± ì˜ì—­ (í•˜ë‹¨) */
        .team-assignment {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
        }

        .team-assignment h3 {
            margin-bottom: 20px;
            color: #333;
            text-align: center;
            font-size: 16px;
        }

        .teams-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .team {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 15px;
            min-height: 120px;
            transition: all 0.3s ease;
            background-color: #f8fafc;
        }

        .team.drag-over {
            border-color: #3b82f6;
            background-color: #dbeafe;
        }

        .team h4 {
            text-align: center;
            margin-bottom: 10px;
            color: #374151;
            font-size: 14px;
        }

        .team-members {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .member-number {
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 36px;
            font-weight: 600;
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
            color: white;
        }

        /* ì„±ë³„ë³„ ìƒ‰ìƒ */
        .member-number.male {
            background-color: #3b82f6;
        }

        .member-number.female {
            background-color: #ec4899;
        }

        /* ì„±ë³„ì´ ì§€ì •ë˜ì§€ ì•Šì€ ê²½ìš° ê¸°ë³¸ ìƒ‰ìƒ */
        .member-number:not(.male):not(.female) {
            background-color: #6b7280;
        }

        .member-number.male:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
        }

        .member-number.female:hover {
            background-color: #be185d;
            transform: translateY(-1px);
        }

        .member-number:not(.male):not(.female):hover {
            background-color: #4b5563;
            transform: translateY(-1px);
        }

        .member-number.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }



        .team-count-input {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            width: 80px;
        }


        /* í•™ìƒ ë²ˆí˜¸ ì˜ì—­ (ìƒë‹¨) */
        .student-numbers-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .student-numbers-section h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
        }

        .student-count-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }

        .student-numbers-container {
            display: flex;
            gap: 20px;
            max-width: 70%;
            margin: 0 auto;
        }

        .student-numbers {
            background-color: #f8fafc;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 15px;
            min-height: 100px;
            transition: all 0.3s ease;
            flex: 1;
        }

        .student-numbers.drag-over {
            border-color: #3b82f6;
            background-color: #dbeafe;
        }

        .unassigned-area {
            background-color: #fef3c7;
            border: 2px dashed #f59e0b;
            border-radius: 8px;
            padding: 15px;
            min-height: 100px;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }

        .unassigned-area.drag-over {
            border-color: #d97706;
            background-color: #fef3c7;
            transform: scale(1.02);
        }

        .unassigned-area h4 {
            margin-bottom: 10px;
            color: #92400e;
            font-size: 14px;
        }

        .numbers-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        /* ì„±ë³„ êµ¬ë¶„ ì˜ì—­ (ì¤‘ê°„) */
        .gender-division {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .gender-division h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
        }

        .gender-areas {
            display: flex;
            gap: 20px;
        }

        .gender-area {
            flex: 1;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 20px;
            min-height: 100px;
            transition: all 0.3s ease;
            text-align: center;
        }

        .gender-area.male {
            background-color: #dbeafe;
            border-color: #3b82f6;
        }

        .gender-area.female {
            background-color: #fce7f3;
            border-color: #ec4899;
        }

        .gender-area.drag-over {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .gender-area h4 {
            margin-bottom: 15px;
            font-size: 14px;
            font-weight: 600;
        }

        .gender-area.male h4 {
            color: #1d4ed8;
        }

        .gender-area.female h4 {
            color: #be185d;
        }

        .gender-numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .gender-number {
            border-radius: 5px;
            padding: 5px 11px;
            font-size: 18px;
            font-weight: 600;
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
        }

        .gender-number.male {
            background-color: #3b82f6;
            color: white;
        }

        .gender-number.female {
            background-color: #ec4899;
            color: white;
        }

        .gender-number:hover {
            transform: translateY(-1px);
        }

        .gender-number.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ì¡° í¸ì„± í”„ë¡œê·¸ë¨</h1>
        <div class="header-buttons">
            <button class="btn btn-warning" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>
            <div class="dropdown" style="position: relative; display: inline-block;">
                <button class="btn btn-info" onclick="toggleLoadMenu()">ë¶ˆëŸ¬ì˜¤ê¸° â–¼</button>
                <div id="loadMenu" class="dropdown-content" style="display: none; position: absolute; background-color: white; min-width: 160px; box-shadow: 0px 8px 16px rgba(0,0,0,0.2); z-index: 1; border-radius: 4px; right: 0; top: 100%; margin-top: 5px;">
                    <a href="#" onclick="loadAssignment()" style="color: black; padding: 8px 12px; text-decoration: none; display: block; font-size: 13px;">JSON ë¶ˆëŸ¬ì˜¤ê¸°</a>
                    <a href="#" onclick="loadFromCSV()" style="color: black; padding: 8px 12px; text-decoration: none; display: block; font-size: 13px;">CSV ë¶ˆëŸ¬ì˜¤ê¸°</a>
                </div>
            </div>
            <div class="dropdown" style="position: relative; display: inline-block;">
                <button class="btn btn-success" onclick="toggleSaveMenu()">ì €ì¥ â–¼</button>
                <div id="saveMenu" class="dropdown-content" style="display: none; position: absolute; background-color: white; min-width: 160px; box-shadow: 0px 8px 16px rgba(0,0,0,0.2); z-index: 1; border-radius: 4px; right: 0; top: 100%; margin-top: 5px;">
                    <a href="#" onclick="saveAsText()" style="color: black; padding: 8px 12px; text-decoration: none; display: block; font-size: 13px;">í…ìŠ¤íŠ¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a>
                    <a href="#" onclick="saveAsCSV()" style="color: black; padding: 8px 12px; text-decoration: none; display: block; font-size: 13px;">CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a>
                    <a href="#" onclick="saveAsJSON()" style="color: black; padding: 8px 12px; text-decoration: none; display: block; font-size: 13px;">ë°ì´í„° ë°±ì—… (JSON)</a>
                </div>
            </div>
        </div>
    </div>

    <div class="main-layout">
        <!-- ì™¼ìª½ 30%: í•™ìƒ ê´€ë¦¬ -->
        <div class="left-panel">
            <!-- í•™ìƒ ë²ˆí˜¸ -->
            <div class="panel-section">
                <div class="section-header">
                    <h3>ğŸ“‹ í•™ìƒ ë²ˆí˜¸</h3>
                    <div class="controls-inline">
                        <input type="number" id="studentCount" class="count-input" value="35" min="1" max="50">
                        <button class="btn btn-sm btn-primary" onclick="updateStudentCount()">ë³€ê²½</button>
                    </div>
                </div>
                <div class="number-area">
                    <div class="numbers-grid" id="numbersGrid">
                        <!-- í•™ìƒ ë²ˆí˜¸ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>

            <!-- ë‚¨ë…€ êµ¬ë¶„ -->
            <div class="panel-section">
                <h3>ğŸ‘« ë‚¨ë…€ êµ¬ë¶„</h3>
                <div class="gender-split">
                    <div class="gender-box male" data-gender="male">
                        <h4>ğŸ‘¦ ë‚¨í•™ìƒ</h4>
                        <div class="gender-numbers" id="male-numbers">
                            <!-- ë‚¨í•™ìƒ ë²ˆí˜¸ë“¤ -->
                        </div>
                    </div>
                    <div class="gender-box female" data-gender="female">
                        <h4>ğŸ‘§ ì—¬í•™ìƒ</h4>
                        <div class="gender-numbers" id="female-numbers">
                            <!-- ì—¬í•™ìƒ ë²ˆí˜¸ë“¤ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ 70%: ì¡°ë³„ í¸ì„± -->
        <div class="right-panel">
            <div class="team-header">
                <h1>ğŸ† ì¡°ë³„ í¸ì„±</h1>
                <div class="team-controls">
                    <label>ì¡° ê°œìˆ˜:</label>
                    <input type="number" id="teamCount" class="count-input" value="6" min="1" max="10">
                    <button class="btn btn-primary" onclick="updateTeams()">ë³€ê²½</button>
                    <button class="btn btn-success" onclick="autoAssignBalanced()">ìë™ í¸ì„±</button>
                    <button class="btn btn-warning" onclick="shuffleAll()">ì¬í¸ì„±</button>
                </div>
            </div>
            
            <div class="teams-grid" id="teamsContainer">
                <!-- ì¡°ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let draggedElement = null;
        let teams = [];
        let availableNumbers = [];
        let maleStudents = [];
        let femaleStudents = [];
        let totalStudents = 35;


        // ì´ˆê¸°í™”
        function init() {
            generateStudentNumbers();
            updateTeams();
            setupGenderAreas();
            updateGenderDisplay();
        }





        // ì„±ë³„ êµ¬ë¶„ ì˜ì—­ ì„¤ì •
        function setupGenderAreas() {
            document.querySelectorAll('.gender-box').forEach(area => {
                area.addEventListener('dragover', handleGenderDragOver);
                area.addEventListener('drop', handleGenderDrop);
                area.addEventListener('dragleave', handleGenderDragLeave);
            });
        }

        // ì„±ë³„ ë²ˆí˜¸ ë“œë˜ê·¸ ì‹œì‘
        function handleGenderDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
        }

        // ì„±ë³„ ë²ˆí˜¸ ë“œë˜ê·¸ ì¢…ë£Œ
        function handleGenderDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedElement = null;
        }

        // ì„±ë³„ ì˜ì—­ ë“œë˜ê·¸ ì˜¤ë²„
        function handleGenderDragOver(e) {
            e.preventDefault();
            // í•™ìƒ ë²ˆí˜¸, ì„±ë³„ ë²ˆí˜¸, ë˜ëŠ” ë©¤ë²„ ë²ˆí˜¸ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš°ë§Œ í—ˆìš©
            if (draggedElement && (draggedElement.classList.contains('student-number') || 
                                   draggedElement.classList.contains('gender-number') ||
                                   draggedElement.classList.contains('member-number'))) {
                e.currentTarget.classList.add('drag-over');
            }
        }

        // ì„±ë³„ ì˜ì—­ ë“œë˜ê·¸ ë– ë‚¨
        function handleGenderDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        // ì„±ë³„ ì˜ì—­ ë“œë¡­
        function handleGenderDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            if (draggedElement) {
                const studentNumber = parseInt(draggedElement.dataset.number);
                const targetGender = e.currentTarget.dataset.gender;
                
                // ê¸°ì¡´ ì„±ë³„ì—ì„œ ì œê±°
                maleStudents = maleStudents.filter(num => num !== studentNumber);
                femaleStudents = femaleStudents.filter(num => num !== studentNumber);
                
                // ìƒˆ ì„±ë³„ì— ì¶”ê°€
                if (targetGender === 'male') {
                    maleStudents.push(studentNumber);
                } else {
                    femaleStudents.push(studentNumber);
                }
                
                // íŒ€ì—ì„œë„ ì œê±° (ì´ë¯¸ ë°°ì •ëœ ê²½ìš°)
                if (draggedElement.dataset.team !== undefined) {
                    const fromTeamIndex = parseInt(draggedElement.dataset.team);
                    teams[fromTeamIndex].members = teams[fromTeamIndex].members.filter(num => num !== studentNumber);
                    teams.forEach((_, index) => updateTeamDisplay(index));
                }
                
                // UI ì—…ë°ì´íŠ¸
                updateGenderDisplay();
                generateStudentNumbers();
            }
        }

        // í•™ìƒ ìˆ˜ ë³€ê²½
        function updateStudentCount() {
            const newCount = parseInt(document.getElementById('studentCount').value);
            if (newCount < 1 || newCount > 50) {
                alert('í•™ìƒ ìˆ˜ëŠ” 1ëª…ì—ì„œ 50ëª… ì‚¬ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (newCount < totalStudents) {
                // í•™ìƒ ìˆ˜ê°€ ì¤„ì–´ë“¤ ë•Œ - ì´ˆê³¼ í•™ìƒ ì œê±°
                for (let i = newCount + 1; i <= totalStudents; i++) {
                    maleStudents = maleStudents.filter(num => num !== i);
                    femaleStudents = femaleStudents.filter(num => num !== i);
                    teams.forEach(team => {
                        team.members = team.members.filter(num => num !== i);
                    });
                }
            }
            
            totalStudents = newCount;
            generateStudentNumbers();
            updateGenderDisplay();
            updateUnassignedDisplay();
            teams.forEach((_, index) => updateTeamDisplay(index));
        }

        // í•™ìƒ ë²ˆí˜¸ ìƒì„±
        function generateStudentNumbers() {
            const numbersGrid = document.getElementById('numbersGrid');
            const studentNumbersPanel = document.querySelector('.number-area');
            numbersGrid.innerHTML = '';
            availableNumbers = [];

            // í•™ìƒ ë²ˆí˜¸ íŒ¨ë„ì— ë“œë¡­ ì´ë²¤íŠ¸ ì¶”ê°€ (í•œ ë²ˆë§Œ)
            if (studentNumbersPanel && !studentNumbersPanel.hasAttribute('data-drop-enabled')) {
                studentNumbersPanel.addEventListener('dragover', handleStudentPanelDragOver);
                studentNumbersPanel.addEventListener('drop', handleStudentPanelDrop);
                studentNumbersPanel.addEventListener('dragleave', handleStudentPanelDragLeave);
                studentNumbersPanel.setAttribute('data-drop-enabled', 'true');
            }

            for (let i = 1; i <= totalStudents; i++) {
                if (!isNumberAssigned(i) && !isNumberGenderAssigned(i)) {
                    availableNumbers.push(i);
                    const numberDiv = document.createElement('div');
                    numberDiv.className = 'student-number';
                    numberDiv.draggable = true;
                    numberDiv.textContent = i;
                    numberDiv.dataset.number = i;

                    // ë“œë˜ê·¸ ì´ë²¤íŠ¸ ì¶”ê°€
                    numberDiv.addEventListener('dragstart', handleDragStart);
                    numberDiv.addEventListener('dragend', handleDragEnd);

                    numbersGrid.appendChild(numberDiv);
                }
            }
        }

        // ì„±ë³„ í• ë‹¹ ì—¬ë¶€ í™•ì¸
        function isNumberGenderAssigned(number) {
            return maleStudents.includes(number) || femaleStudents.includes(number);
        }

        // ì„±ë³„ êµ¬ë¶„ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateGenderDisplay() {
            const maleContainer = document.getElementById('male-numbers');
            const femaleContainer = document.getElementById('female-numbers');
            
            // íŒ€ì— ë°°ì •ëœ í•™ìƒë“¤ì€ ì œì™¸í•˜ê³  í‘œì‹œ
            const assignedNumbers = [];
            teams.forEach(team => {
                assignedNumbers.push(...team.members);
            });
            
            // ë‚¨í•™ìƒ í‘œì‹œ (íŒ€ì— ë°°ì •ë˜ì§€ ì•Šì€ í•™ìƒë§Œ)
            maleContainer.innerHTML = maleStudents
                .filter(num => !assignedNumbers.includes(num))
                .sort((a, b) => a - b)
                .map(num => `<span class="gender-number male" draggable="true" data-number="${num}" data-gender="male">${num}</span>`)
                .join('');
            
            // ì—¬í•™ìƒ í‘œì‹œ (íŒ€ì— ë°°ì •ë˜ì§€ ì•Šì€ í•™ìƒë§Œ)
            femaleContainer.innerHTML = femaleStudents
                .filter(num => !assignedNumbers.includes(num))
                .sort((a, b) => a - b)
                .map(num => `<span class="gender-number female" draggable="true" data-number="${num}" data-gender="female">${num}</span>`)
                .join('');
            
            // ë“œë˜ê·¸ ì´ë²¤íŠ¸ ì¶”ê°€
            document.querySelectorAll('.gender-number').forEach(element => {
                element.addEventListener('dragstart', handleGenderDragStart);
                element.addEventListener('dragend', handleGenderDragEnd);
            });
        }

        // ë²ˆí˜¸ê°€ ì´ë¯¸ ë°°ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
        function isNumberAssigned(number) {
            return teams.some(team => team.members.includes(number));
        }

        // ì¡° ê°œìˆ˜ ì—…ë°ì´íŠ¸
        function updateTeams() {
            const teamCount = parseInt(document.getElementById('teamCount').value);
            const teamsContainer = document.getElementById('teamsContainer');
            
            // ê¸°ì¡´ íŒ€ ë°ì´í„° ë³´ì¡´í•˜ë©´ì„œ íŒ€ ê°œìˆ˜ ì¡°ì •
            while (teams.length < teamCount) {
                teams.push({ members: [] });
            }
            while (teams.length > teamCount) {
                // ì œê±°ë˜ëŠ” íŒ€ì˜ ë©¤ë²„ë“¤ì„ ë‹¤ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ë²ˆí˜¸ë¡œ ë˜ëŒë¦¼
                const removedTeam = teams.pop();
                // ë²ˆí˜¸ ê·¸ë¦¬ë“œ ìƒˆë¡œê³ ì¹¨ì€ ë‚˜ì¤‘ì— í•œ ë²ˆë§Œ
            }

            // UI ì—…ë°ì´íŠ¸
            teamsContainer.innerHTML = '';
            teams.forEach((team, index) => {
                const teamDiv = document.createElement('div');
                teamDiv.className = 'team';
                teamDiv.dataset.teamIndex = index;

                // ë“œë¡­ ì´ë²¤íŠ¸ ì¶”ê°€
                teamDiv.addEventListener('dragover', handleDragOver);
                teamDiv.addEventListener('drop', handleDrop);
                teamDiv.addEventListener('dragleave', handleDragLeave);

                teamsContainer.appendChild(teamDiv);
            });

            // ëª¨ë“  ì¡°ì˜ í‘œì‹œ ì—…ë°ì´íŠ¸
            teams.forEach((_, index) => updateTeamDisplay(index));
            
            generateStudentNumbers(); // ë²ˆí˜¸ ê·¸ë¦¬ë“œ ìƒˆë¡œê³ ì¹¨
        }

        // ë“œë˜ê·¸ ì‹œì‘
        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
        }

        // ë“œë˜ê·¸ ì¢…ë£Œ
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedElement = null;
        }

        // ë©¤ë²„ ë“œë˜ê·¸ ì‹œì‘
        function handleMemberDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.stopPropagation(); // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€
        }

        // ë©¤ë²„ ë“œë˜ê·¸ ì¢…ë£Œ
        function handleMemberDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedElement = null;
        }

        // ë“œë˜ê·¸ ì˜¤ë²„
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        // ë“œë˜ê·¸ ë– ë‚¨
        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        // ë“œë¡­
        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            if (draggedElement) {
                const teamIndex = parseInt(e.currentTarget.dataset.teamIndex);
                const studentNumber = parseInt(draggedElement.dataset.number);
                
                // ê¸°ì¡´ íŒ€ì—ì„œ ì œê±° (ë©¤ë²„ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš°)
                if (draggedElement.dataset.team !== undefined) {
                    const fromTeamIndex = parseInt(draggedElement.dataset.team);
                    teams[fromTeamIndex].members = teams[fromTeamIndex].members.filter(num => num !== studentNumber);
                    updateTeamDisplay(fromTeamIndex);
                }
                
                // ì„±ë³„ êµ¬ë¶„ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš° - ì„±ë³„ ì •ë³´ëŠ” ìœ ì§€í•˜ê³  UIì—ì„œë§Œ ì œê±°
                if (draggedElement.classList.contains('gender-number')) {
                    // ì„±ë³„ ë°°ì—´ì—ì„œëŠ” ì œê±°í•˜ì§€ ì•Šê³  ì„±ë³„ ì •ë³´ ìœ ì§€
                    // ë‹¨ì§€ UIë§Œ ì—…ë°ì´íŠ¸
                }
                
                // ìƒˆ íŒ€ì— í•™ìƒ ì¶”ê°€
                teams[teamIndex].members.push(studentNumber);
                
                // UI ì—…ë°ì´íŠ¸
                updateTeamDisplay(teamIndex);
                updateGenderDisplay(); // ì„±ë³„ í‘œì‹œë„ ì—…ë°ì´íŠ¸
                generateStudentNumbers(); // ì‚¬ìš© ê°€ëŠ¥í•œ ë²ˆí˜¸ ìƒˆë¡œê³ ì¹¨
            }
        }

        // í•™ìƒ ë²ˆí˜¸ íŒ¨ë„ ë“œë˜ê·¸ ì˜¤ë²„
        function handleStudentPanelDragOver(e) {
            e.preventDefault();
            // ë©¤ë²„ ë²ˆí˜¸ ë˜ëŠ” ì„±ë³„ ë²ˆí˜¸ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš°ë§Œ í—ˆìš©
            if (draggedElement && (draggedElement.classList.contains('member-number') || draggedElement.classList.contains('gender-number'))) {
                e.currentTarget.classList.add('drag-over');
            }
        }

        // í•™ìƒ ë²ˆí˜¸ íŒ¨ë„ ë“œë˜ê·¸ ë– ë‚¨
        function handleStudentPanelDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        // í•™ìƒ ë²ˆí˜¸ íŒ¨ë„ ë“œë¡­
        function handleStudentPanelDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            // ë©¤ë²„ ë²ˆí˜¸ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš°ë§Œ ì²˜ë¦¬
            if (draggedElement && draggedElement.classList.contains('member-number')) {
                const studentNumber = parseInt(draggedElement.dataset.number);
                const fromTeamIndex = parseInt(draggedElement.dataset.team);
                
                // íŒ€ì—ì„œ ì œê±°
                teams[fromTeamIndex].members = teams[fromTeamIndex].members.filter(num => num !== studentNumber);
                
                // UI ì—…ë°ì´íŠ¸
                updateTeamDisplay(fromTeamIndex);
                generateStudentNumbers(); // ì‚¬ìš© ê°€ëŠ¥í•œ ë²ˆí˜¸ ìƒˆë¡œê³ ì¹¨
            }
            // ì„±ë³„ ë²ˆí˜¸ì—ì„œ ë“œë˜ê·¸í•œ ê²½ìš° ì²˜ë¦¬
            else if (draggedElement && draggedElement.classList.contains('gender-number')) {
                const studentNumber = parseInt(draggedElement.dataset.number);
                
                // ì„±ë³„ ë°°ì—´ì—ì„œ ì œê±°
                maleStudents = maleStudents.filter(num => num !== studentNumber);
                femaleStudents = femaleStudents.filter(num => num !== studentNumber);
                
                // UI ì—…ë°ì´íŠ¸
                updateGenderDisplay();
                generateStudentNumbers();
            }
        }

        // í•™ìƒì˜ ì„±ë³„ í™•ì¸ í•¨ìˆ˜
        function getStudentGender(studentNumber) {
            if (maleStudents.includes(studentNumber)) {
                return 'male';
            } else if (femaleStudents.includes(studentNumber)) {
                return 'female';
            }
            return 'unknown';
        }

        // íŒ€ í‘œì‹œ ì—…ë°ì´íŠ¸ (ê°„ë‹¨í•œ ë²„ì „)
        function updateTeamDisplay(teamIndex) {
            const teamDiv = document.querySelector(`[data-team-index="${teamIndex}"]`);
            if (!teamDiv) return;
            
            const team = teams[teamIndex];
            
            teamDiv.innerHTML = `
                <div class="team-title">
                    <h4>${teamIndex + 1}ì¡°</h4>
                </div>
                <div class="team-members" id="team-${teamIndex}">
                    ${team.members.map(num => {
                        const gender = getStudentGender(num);
                        const genderClass = gender !== 'unknown' ? gender : '';
                        return `<span class="member-number ${genderClass}" draggable="true" data-number="${num}" data-team="${teamIndex}" data-gender="${gender}" onclick="removeFromTeam(${teamIndex}, ${num})">${num}</span>`;
                    }).join('')}
                </div>
            `;
            
            // ìƒˆë¡œ ìƒì„±ëœ ë©¤ë²„ ë²ˆí˜¸ë“¤ì— ë“œë˜ê·¸ ì´ë²¤íŠ¸ ì¶”ê°€
            teamDiv.querySelectorAll('.member-number').forEach(memberElement => {
                memberElement.addEventListener('dragstart', handleMemberDragStart);
                memberElement.addEventListener('dragend', handleMemberDragEnd);
            });
        }

        // íŒ€ì—ì„œ ì œê±° (ì„±ë³„ ì§€ì •ìœ¼ë¡œ ë˜ëŒë¦¼)
        function removeFromTeam(teamIndex, studentNumber) {
            teams[teamIndex].members = teams[teamIndex].members.filter(num => num !== studentNumber);
            updateTeamDisplay(teamIndex);
            updateGenderDisplay();
            generateStudentNumbers();
        }

        // ì „ì²´ ì´ˆê¸°í™”
        function resetAll() {
            if (confirm('ëª¨ë“  ì¡° í¸ì„±ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                teams.forEach(team => team.members = []);
                maleStudents = [];
                femaleStudents = [];
                teams.forEach((_, index) => updateTeamDisplay(index));
                updateGenderDisplay();
                generateStudentNumbers();
            }
        }


        // ê· ë“± ìë™ í¸ì„±
        function autoAssignBalanced() {
            resetAll();
            
            const allNumbers = Array.from({length: 35}, (_, i) => i + 1);
            const shuffled = allNumbers.sort(() => Math.random() - 0.5);
            
            let currentTeam = 0;
            shuffled.forEach(number => {
                teams[currentTeam].members.push(number);
                currentTeam = (currentTeam + 1) % teams.length;
            });
            
            teams.forEach((_, index) => updateTeamDisplay(index));
            generateStudentNumbers();
        }

        // ëœë¤ í¸ì„±
        function autoAssignRandom() {
            resetAll();
            
            const allNumbers = Array.from({length: 35}, (_, i) => i + 1);
            const shuffled = allNumbers.sort(() => Math.random() - 0.5);
            
            shuffled.forEach(number => {
                const randomTeam = Math.floor(Math.random() * teams.length);
                teams[randomTeam].members.push(number);
            });
            
            teams.forEach((_, index) => updateTeamDisplay(index));
            generateStudentNumbers();
        }

        // ì„ì–´ì„œ ì¬í¸ì„±
        function shuffleAll() {
            const allAssignedNumbers = [];
            teams.forEach(team => {
                allAssignedNumbers.push(...team.members);
                team.members = [];
            });
            
            const shuffled = allAssignedNumbers.sort(() => Math.random() - 0.5);
            let currentTeam = 0;
            shuffled.forEach(number => {
                teams[currentTeam].members.push(number);
                currentTeam = (currentTeam + 1) % teams.length;
            });
            
            teams.forEach((_, index) => updateTeamDisplay(index));
            generateStudentNumbers();
        }


        // ì €ì¥ ë©”ë‰´ í† ê¸€
        function toggleSaveMenu() {
            const menu = document.getElementById('saveMenu');
            menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
            // ë¶ˆëŸ¬ì˜¤ê¸° ë©”ë‰´ëŠ” ë‹«ê¸°
            document.getElementById('loadMenu').style.display = 'none';
        }

        // ë¶ˆëŸ¬ì˜¤ê¸° ë©”ë‰´ í† ê¸€
        function toggleLoadMenu() {
            const menu = document.getElementById('loadMenu');
            menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
            // ì €ì¥ ë©”ë‰´ëŠ” ë‹«ê¸°
            document.getElementById('saveMenu').style.display = 'none';
        }

        // ë©”ë‰´ ë‹«ê¸° (ë‹¤ë¥¸ ê³³ í´ë¦­ ì‹œ)
        document.addEventListener('click', function(event) {
            const saveMenu = document.getElementById('saveMenu');
            const loadMenu = document.getElementById('loadMenu');
            const dropdown = event.target.closest('.dropdown');
            if (!dropdown) {
                saveMenu.style.display = 'none';
                loadMenu.style.display = 'none';
            }
        });

        // í…ìŠ¤íŠ¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
        function saveAsText() {
            const assignment = getAssignmentData();
            if (!assignment.result) {
                alert('í¸ì„±ëœ ì¡°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const content = `ì¡° í¸ì„± ê²°ê³¼\n${'='.repeat(20)}\n\n${assignment.result}\n\në‚¨í•™ìƒ: ${maleStudents.sort((a,b) => a-b).join(', ')}\nì—¬í•™ìƒ: ${femaleStudents.sort((a,b) => a-b).join(', ')}`;
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ì¡°í¸ì„±_${new Date().toISOString().slice(0,10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            document.getElementById('saveMenu').style.display = 'none';
        }

        // JSON ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ
        function saveAsJSON() {
            const data = {
                teams: teams,
                maleStudents: maleStudents,
                femaleStudents: femaleStudents,
                timestamp: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ì¡°í¸ì„±_ë°±ì—…_${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            document.getElementById('saveMenu').style.display = 'none';
        }

        // CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ
        function saveAsCSV() {
            const assignment = getAssignmentData();
            if (!assignment.assignment || assignment.assignment.length === 0) {
                alert('í¸ì„±ëœ ì¡°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // CSV í—¤ë”
            let csvContent = 'ì¡°,í•™ìƒë²ˆí˜¸,ì„±ë³„\n';
            
            // ê° ì¡°ë³„ë¡œ ë°ì´í„° ì¶”ê°€
            assignment.assignment.forEach(team => {
                team.members.forEach(studentNum => {
                    const gender = getStudentGender(studentNum);
                    const genderText = gender === 'male' ? 'ë‚¨' : gender === 'female' ? 'ì—¬' : 'ë¯¸ì§€ì •';
                    csvContent += `${team.teamNumber}ì¡°,${studentNum},${genderText}\n`;
                });
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ì¡°í¸ì„±_${new Date().toISOString().slice(0,10)}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            document.getElementById('saveMenu').style.display = 'none';
        }



        // ì¡° í¸ì„± ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function getAssignmentData() {
            const assignment = teams.map((team, index) => ({
                teamNumber: index + 1,
                members: team.members.sort((a, b) => a - b),
                maleMembers: team.members.filter(num => maleStudents.includes(num)).sort((a, b) => a - b),
                femaleMembers: team.members.filter(num => femaleStudents.includes(num)).sort((a, b) => a - b)
            })).filter(team => team.members.length > 0);
            
            const result = assignment.map(team => {
                const genderInfo = [];
                if (team.maleMembers.length > 0) genderInfo.push(`ë‚¨: ${team.maleMembers.join(', ')}`);
                if (team.femaleMembers.length > 0) genderInfo.push(`ì—¬: ${team.femaleMembers.join(', ')}`);
                const genderDetail = genderInfo.length > 0 ? ` (${genderInfo.join(', ')})` : '';
                return `${team.teamNumber}ì¡°: ${team.members.join(', ')}${genderDetail}`;
            }).join('\n');
            
            return { assignment, result };
        }

        // JSON íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadAssignment() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (confirm('í˜„ì¬ ì‘ì—…ì„ ë®ì–´ì“°ê³  íŒŒì¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            teams = data.teams || [];
                            maleStudents = data.maleStudents || [];
                            femaleStudents = data.femaleStudents || [];
                            
                            // UI ì—…ë°ì´íŠ¸
                            document.getElementById('teamCount').value = teams.length;
                            updateTeams();
                            updateGenderDisplay();
                            generateStudentNumbers();
                            
                            alert('JSON íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤!');
                        }
                    } catch (error) {
                        alert('JSON íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
            document.getElementById('loadMenu').style.display = 'none';
        }
        
        // CSV íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromCSV() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const csvText = e.target.result;
                        const lines = csvText.split('\n');
                        
                        if (lines.length < 2) {
                            alert('CSV íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                            return;
                        }
                        
                        if (confirm('í˜„ì¬ ì‘ì—…ì„ ë®ì–´ì“°ê³  CSV íŒŒì¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            // ì´ˆê¸°í™”
                            teams = [];
                            maleStudents = [];
                            femaleStudents = [];
                            
                            // CSV íŒŒì‹± (ì²« ì¤„ì€ í—¤ë”ì´ë¯€ë¡œ ì œì™¸)
                            const teamMap = new Map();
                            
                            for (let i = 1; i < lines.length; i++) {
                                const line = lines[i].trim();
                                if (!line) continue;
                                
                                const [teamName, studentNum, gender] = line.split(',');
                                if (!teamName || !studentNum) continue;
                                
                                const teamIndex = parseInt(teamName.replace('ì¡°', '')) - 1;
                                const num = parseInt(studentNum);
                                
                                if (isNaN(teamIndex) || isNaN(num)) continue;
                                
                                // íŒ€ ë°°ì—´ í™•ì¥
                                while (teams.length <= teamIndex) {
                                    teams.push({ members: [] });
                                }
                                
                                teams[teamIndex].members.push(num);
                                
                                // ì„±ë³„ ì •ë³´ ì €ì¥
                                if (gender && gender.trim() === 'ë‚¨') {
                                    maleStudents.push(num);
                                } else if (gender && gender.trim() === 'ì—¬') {
                                    femaleStudents.push(num);
                                }
                            }
                            
                            // UI ì—…ë°ì´íŠ¸
                            document.getElementById('teamCount').value = teams.length;
                            updateTeams();
                            updateGenderDisplay();
                            generateStudentNumbers();
                            
                            alert('CSV íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤!');
                        }
                    } catch (error) {
                        alert('CSV íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
            document.getElementById('loadMenu').style.display = 'none';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
